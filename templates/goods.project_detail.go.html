{{ define "content" }}

<ol class="breadcrumb">
  <li><a href="/v1/">大堂</a></li>
  <li><a href="/v1/project/detail?uuid={{ .ProjectBean.Project.Uuid }}">{{ .ProjectBean.Project.Title }}@茶台</a></li>
  <li class="active">项目物资详情</li>
  <li>
    {{ template "component_sess_capacity" . }}
  </li>
</ol>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">
      <i class="bi-box" style="font-size: 1.5rem; color: #5cb85c;"></i>
      项目物资清单
      <span class="label label-info pull-right">
        {{ len .GoodsProjectList }}项物资
      </span>
    </h3>
  </div>

  <div class="panel-body">
    <!-- 项目基本信息 -->
    <div class="row">
      <div class="col-md-6">
        <h4>项目信息</h4>
        <table class="table table-bordered">
          <tr>
            <td><strong>项目名称</strong></td>
            <td>{{ .ProjectBean.Project.Title }}</td>
          </tr>
          <tr>
            <td><strong>项目状态</strong></td>
            <td>
              <span class="label label-{{ if eq .ProjectBean.Project.Status 0 }}warning{{ else if eq .ProjectBean.Project.Status 1 }}success{{ else if eq .ProjectBean.Project.Status 2 }}info{{ else }}default{{ end }}">
                {{ .ProjectBean.Project.StatusString }}
              </span>
            </td>
          </tr>
          <tr>
            <td><strong>创建时间</strong></td>
            <td>{{ .ProjectBean.Project.CreatedAtDate }}</td>
          </tr>
          <tr>
            <td><strong>物资总数</strong></td>
            <td><span class="badge">{{ len .GoodsProjectList }}</span></td>
          </tr>
        </table>
      </div>
      
      <div class="col-md-6">
        <h4>操作面板</h4>
        <div class="panel panel-{{ if .IsVerifier }}success{{ else }}default{{ end }}">
          <div class="panel-body text-center">
            {{ if .IsVerifier }}
            <i class="glyphicon glyphicon-plus-sign" style="font-size: 3rem; color: #5cb85c;"></i>
            <h5><strong>管理权限</strong></h5>
            <a href="/v1/goods/project_new?project_id={{ .ProjectBean.Project.Id }}" class="btn btn-primary">
              <span class="glyphicon glyphicon-plus"></span> 添加物资
            </a>
            {{ else }}
            <i class="glyphicon glyphicon-eye-open" style="font-size: 3rem; color: #777;"></i>
            <h5><strong>查看权限</strong></h5>
            <p class="text-muted">仅可查看物资信息</p>
            {{ end }}
          </div>
        </div>
      </div>
    </div>

    <!-- 物资列表 -->
    {{ if .GoodsProjectList }}
    <div class="row">
      <div class="col-md-12">
        <h4><span class="glyphicon glyphicon-list"></span> 物资清单</h4>
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>物资名称</th>
                <th>数量</th>
                <th>类别</th>
                <th>提供方</th>
                <th>状态</th>
                <th>预期用途</th>
                <th>备注</th>
              </tr>
            </thead>
            <tbody>
              {{ range $index, $gp := .GoodsProjectList }}
              {{ $goods := index $.GoodsList $index }}
              <tr>
                <td>
                  <strong>{{ $goods.Name }}</strong>
                  {{ if $goods.Nickname }}
                  <br><small class="text-muted">{{ $goods.Nickname }}</small>
                  {{ end }}
                  {{ if $goods.BrandName }}
                  <br><small class="text-info">{{ $goods.BrandName }}</small>
                  {{ end }}
                </td>
                <td><span class="badge">{{ $gp.Quantity }}</span></td>
                <td>
                  <span class="label {{ if eq $gp.Category 1 }}label-primary{{ else }}label-warning{{ end }}">
                    {{ $gp.CategoryString }}
                  </span>
                </td>
                <td>
                  <span class="label {{ if eq $gp.ProviderType 1 }}label-success{{ else }}label-info{{ end }}">
                    {{ $gp.ProviderTypeString }}
                  </span>
                </td>
                <td>
                  <span class="label {{ if eq $gp.Status 0 }}label-success{{ else if eq $gp.Status 1 }}label-warning{{ else }}label-default{{ end }}">
                    {{ AvailabilityString $gp.Status }}
                  </span>
                </td>
                <td>
                  {{ if $gp.ExpectedUsage }}
                  <small>{{ $gp.ExpectedUsage }}</small>
                  {{ else }}
                  <span class="text-muted">-</span>
                  {{ end }}
                </td>
                <td>
                  {{ if $gp.Notes }}
                  <small>{{ $gp.Notes }}</small>
                  {{ else }}
                  <span class="text-muted">-</span>
                  {{ end }}
                </td>
              </tr>
              {{ end }}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    {{ else }}
    <!-- 空状态 -->
    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <div class="panel-body text-center" style="padding: 40px;">
            <i class="glyphicon glyphicon-inbox" style="font-size: 4rem; color: #ccc;"></i>
            <h4 class="text-muted">暂无物资记录</h4>
            <p class="text-muted">该项目还没有添加任何物资</p>
            {{ if .IsAdmin }}
            <a href="/v1/goods/project_new?project_id={{ .ProjectBean.Project.Id }}" class="btn btn-primary">
              <span class="glyphicon glyphicon-plus"></span> 添加第一个物资
            </a>
            {{ end }}
          </div>
        </div>
      </div>
    </div>
    {{ end }}

    <!-- 操作按钮 -->
    <div class="text-center" style="margin-top: 20px;">
      <a href="/v1/project/detail?uuid={{ .ProjectBean.Project.Uuid }}" class="btn btn-default">
        <span class="glyphicon glyphicon-arrow-left"></span> 返回项目
      </a>
      {{ if .IsAdmin }}
      <a href="/v1/goods/project_new?project_id={{ .ProjectBean.Project.Id }}" class="btn btn-primary">
        <span class="glyphicon glyphicon-plus"></span> 添加物资
      </a>
      {{ end }}
    </div>
  </div>

  <div class="panel-footer">
    <i class="bi-info-circle" style="font-size: 2rem; color: blue;"></i>
    茶博士：项目物资清单展示了该项目所需的全部物资信息，包括数量、类别、提供方和使用状态等详细信息。
  </div>
</div>

{{ end }}