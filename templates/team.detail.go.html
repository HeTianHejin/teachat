{{ define "content"}}

{{/* 这是指定团队详情展示页面-面包屑导航栏 */}}

{{ with .TeamBean }}{{/* 检测Teambean非空 --开始 */}}
<ol class="breadcrumb">
  <li><a href="/v1/">大堂</a></li>
  <li><a href="/v1/teams/joined">团队事项</a></li>
  <li>{{ .Team.Name }}</li>
  <li class="=active">$事业茶团详情</li>
</ol>


<!-- 团队标识和作业成就 -->
<div class="row" style="margin: 20px 0;">
  <div class="col-xs-6">
    <img class="img-circle" src="/v1/static/image/team/{{ .Team.Logo }}.jpeg" alt="{{ .Team.Name }}" style="width: 48px;">
  </div>
  <div class="col-xs-6 text-right">
    <a href="#" class="btn btn-success btn-block">
      <i class="glyphicon glyphicon-star"></i> 作业成就
    </a>
  </div>
</div>






{{/* 这是指定茶团详情展示页面 */}}
<div class="media">

  <div class="media-left">
    {{ template "component_avatar_name_gender" .Founder }}
  </div>

  <div class="media-body">
    <div class="panel panel-default">
      <div class="panel-heading">
        <div class="row">

          <div class="col-xs-4">
            <span style="font-style: italic;">
              （<a href="/v1/family/detail?id={{ .FounderDefaultFamily.Uuid }}" title="查看家庭详情">
                {{ .FounderDefaultFamily.Name }}</a>）
            </span>
          </div>

          <div class="col-xs-4 text-center">
            {{ if .Team.IsPrivate }}
            <span class="label label-danger">私密</span>
            {{ end }}
            {{ if .Team.IsOpen }}
            <i class="bi-people" style="font-size: 2rem;"></i>

            <span class="label label-success">{{ .Team.TeamProperty }}
              {{ else }}
              <i class="bi-people-fill" style="font-size: 2rem;"></i>
              <span class="label label-default">{{ .Team.TeamProperty }}
                {{ end }}
              </span>

          </div>

          <div class="col-xs-4 text-right">
            {{ .CreatedAtDate }}
          </div>
        </div>
      </div>
      <div class="panel-body">
        <div class="text-center" style="font-size: large;">
          {{ .Team.Name }}
          @<span style="font-style: italic;">
            {{ if $.GroupBean }}
            <a href="/v1/group/detail?id={{ $.GroupBean.Group.Uuid }}">{{ $.GroupBean.Group.Abbreviation }}</a>
            {{ else }}喝茶集团{{ end }}
          </span>
        </div>

        {{ if .Team.Tags }}
        <div style="margin-top: 10px;">
          <i class="glyphicon glyphicon-tags"></i>
          {{ range .Team.GetTags }}
          <span class="label label-info" style="margin-right: 5px;">{{ . }}</span>
          {{ end }}
        </div>
        {{ end }}

        <span style="white-space: pre-wrap;">
          {{ .Team.Mission }}
        </span>

      </div>
      <div class="panel-footer">
        <span style="margin-inline-end: 20px;" title="团号">
          <span class="glyphicon glyphicon-flag" aria-hidden="true"></span>
          {{ .Team.Id }}
        </span>

        <span style="margin-inline-end: 20px;" title="成员数">
          <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
          {{ .MembersCount }}
        </span>

        {{ if $.IsMember }}
        <span style="margin-inline-end: 20px;" title="团队消息盒">
          {{ if $.MessageBox }}
          <a href="/v1/message_box/detail?uuid={{ $.MessageBox.Uuid }}" style="text-decoration: none; color: inherit;">
            <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
            {{ if gt $.MessageCount 0 }}<span class="badge" style="background-color: #d9534f;">{{ $.MessageCount
              }}</span>{{ end }}
          </a>
          {{ else }}
          <a href="/v1/message_box/detail?team_uuid={{ .Team.Uuid }}" style="text-decoration: none; color: inherit;">
            <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
          </a>
          {{ end }}
        </span>
        {{ end }}

      </div>
    </div>

    <div class="my-4">
      <!-- 团队核心成员功能按钮 -->
      {{ if $.IsCoreMember }}
      <div class="btn-group" role="group" style="margin-bottom: 15px;">
        {{ if or $.IsCEO $.IsFounder }}
        <a href="/v1/team/manage?uuid={{ .Team.Uuid }}" class="btn btn-primary">
          <i class="glyphicon glyphicon-cog"></i> 管理团队
        </a>
        {{ end }}

        {{ if or $.IsCEO $.IsFounder }}
        {{ if $.GroupBean }}
        <a href="/v1/group/detail?id={{ $.GroupBean.Group.Uuid }}" class="btn btn-info">
          <i class="glyphicon glyphicon-th-large"></i> 查看所属集团
        </a>
        {{ else }}
        <a href="/v1/group/new?team_id={{ .Team.Uuid }}" class="btn btn-success">
          <i class="glyphicon glyphicon-plus"></i> 创建集团
        </a>
        {{ end }}
        {{ end }}

        <a href="/v1/team/applications?uuid={{ .Team.Uuid }}" class="btn btn-default">
          <i class="glyphicon glyphicon-inbox"></i> 查看申请{{ if $.HasApplication }}<span class="badge">!</span>{{ end }}
        </a>
        <a href="/v1/team/invitations?uuid={{ .Team.Uuid }}" class="btn btn-default">
          <i class="glyphicon glyphicon-send"></i> 查看邀请
        </a>
        <a href="/v1/team/resignations?uuid={{ .Team.Uuid }}" class="btn btn-default">
          <i class="glyphicon glyphicon-log-out"></i> 查看退团{{ if $.HasResignation }}<span class="badge">!</span>{{ end }}
        </a>
      </div>
      {{ end }}
      {{ if .Team.IsOpen }}
      {{ if $.IsMember }}

      {{ else }}{{/* 不是茶团成员 */}}
      <div class="text-right">
        <a href="/v1/team_member/application/new?uuid={{ .Team.Uuid }}">申请加盟</a>
        {{ if .Team.IsOpen }}
        <span style="margin: 0 10px;">|</span>
        <a href="/v1/message/announcement/send?team_uuid={{ .Team.Uuid }}" style="color: #28a745;">
          <i class="bi bi-megaphone"></i> 发送布告
        </a>
        {{ end }}
      </div>
      {{ end }}{{/* 检查是否团队成员结束 */}}

      {{ else }}{{/* 是封闭式茶团 */}}
      <p class="text-center">
        <span class="glyphicon glyphicon-info-sign" aria-hidden="true"> </span>
        茶博士提示：封闭式茶团不接受发送布告消息
      </p>
      {{ end }}
      <hr />
      <!-- 团队功能导航 -->
      <ul class="nav nav-tabs nav-justified">
        <li class="active"><a href="#">在座成员</a></li>
        <li><a href="/v1/tea/team/account?team_id={{ .Team.Id }}">茶叶账户</a></li>
        <li><a href="/v1/skills/team_list?uuid={{ .Team.Uuid }}">技能</a></li>
        <li><a href="/v1/magics/team_list?uuid={{ .Team.Uuid }}">法力</a></li>
        <li><a href="/v1/goods/team?uuid={{ .Team.Uuid }}">装备物资</a></li>

        <li><a href="/v1/team_member/role_changed?uuid={{ .Team.Uuid }}">角色变动</a></li>
        <li><a href="/v1/team/members/left?uuid={{ .Team.Uuid }}">离开成员</a></li>
      </ul>
    </div>

    {{ end }}{{/* 检测Teambean非空 --结束 */}}

    {{/* 这是茶团核心成员展示页面 */}}
    {{ range .CoreMemberBeanSlice }}

    <div class="media">
      <div class="media-left">
        {{ template "component_avatar_name_gender" .Member }}
      </div>
      <div class="media-body">

        <span style="font-style: italic;">
          （<a href="/v1/family/detail?id={{ .MemberDefaultFamily.Uuid }}">{{ .MemberDefaultFamily.Name }}</a>，
          <a href="/v1/team/detail?uuid={{ .MemberDefaultTeam.Uuid }}">{{ .MemberDefaultTeam.Abbreviation }}</a>）
        </span>


        <p>团队角色： <span class="label label-primary">{{ RoleName .TeamMember.Role }}</span></p>

        <p>成员状态：
          <span
            class="label {{ if eq .TeamMember.Status 0 }}label-danger{{ else if eq .TeamMember.Status 1 }}label-success{{ else if eq .TeamMember.Status 2 }}label-warning{{ else if eq .TeamMember.Status 3 }}label-default{{ else }}label-info{{ end }}">
            {{ .TeamMember.GetStatus }}
          </span>
        </p>

        <p>茶友号：{{ .Member.Id }}</p>
        <p style="font-style: italic;">{{ .Member.Email }}</p>

        <p>加盟时间：{{ .CreatedAtDate }}</p>

        {{ if $.IsMember }}
        <div class="btn-group" role="group" style="margin-top: 10px;">
          <a href="/v1/message/send?team_uuid={{ $.TeamBean.Team.Uuid }}&receiver_id={{ .Member.Id }}"
            class="btn btn-sm btn-info">
            <i class="bi bi-envelope"></i> 发送纸条
          </a>
          <a href="/v1/workbook/list?team_id={{ $.TeamBean.Team.Uuid }}&member_id={{ .Member.Id }}"
            class="btn btn-sm btn-success">
            <i class="bi bi-book"></i> 工作簿
          </a>
          {{ if $.IsVerifierTeamMember }}
          <a href="/v1/verifier/workspace?team_id={{ $.TeamBean.Team.Uuid }}&member_id={{ .Member.Id }}" class="btn btn-sm btn-warning">
            <i class="bi bi-clipboard-check"></i> 见证工作间
            {{ if gt $.PendingOrderCount 0 }}
            <span class="badge">{{ $.PendingOrderCount }}</span>
            {{ end }}
          </a>
          {{ else }}
          <a href="/v1/office-desk?team_id={{ $.TeamBean.Team.Uuid }}&member_id={{ .Member.Id }}"
            class="btn btn-sm btn-primary">
            <i class="bi bi-pc-display-horizontal"></i> 办公桌
          </a>
          {{ end }}
        </div>
        {{ end }}

      </div>
    </div>

    <hr />
    {{ end }}

    {{ range .NormalMemberBeanSlice }}

    <div class="media">
      <div class="media-left">
        {{ template "component_avatar_name_gender" .Member }}
      </div>
      <div class="media-body">

        <span style="font-style: italic;">
          （<a href="/v1/family/detail?id={{ .MemberDefaultFamily.Uuid }}">{{ .MemberDefaultFamily.Name }}</a>，
          <a href="/v1/team/detail?uuid={{ .MemberDefaultTeam.Uuid }}">{{ .MemberDefaultTeam.Abbreviation }}</a>）
        </span>


        <p>团队角色： <span class="label label-primary">{{ RoleName .TeamMember.Role }}</span></p>

        <p>成员状态：
          <span
            class="label {{ if eq .TeamMember.Status 0 }}label-danger{{ else if eq .TeamMember.Status 1 }}label-success{{ else if eq .TeamMember.Status 2 }}label-warning{{ else if eq .TeamMember.Status 3 }}label-default{{ else }}label-info{{ end }}">
            {{ .TeamMember.GetStatus }}
          </span>
        </p>

        <p>茶友号：{{ .Member.Id }}</p>
        <p style="font-style: italic;">{{ .Member.Email }}</p>

        <p>加盟时间：{{ .CreatedAtDate }}</p>

        {{ if $.IsMember }}
        <div class="btn-group" role="group" style="margin-top: 10px;">
          <a href="/v1/message/send?team_uuid={{ $.TeamBean.Team.Uuid }}&receiver_id={{ .Member.Id }}"
            class="btn btn-sm btn-primary">
            <i class="bi bi-envelope"></i> 发送纸条
          </a>
          <a href="/v1/workbook/list?team_id={{ $.TeamBean.Team.Uuid }}&member_id={{ .Member.Id }}"
            class="btn btn-sm btn-success">
            <i class="bi bi-Journal-text"></i> 工作簿
          </a>
          {{ if $.IsVerifierTeamMember }}
          <a href="/v1/verifier/workspace?team_uuid={{ $.TeamBean.Team.Uuid }}" class="btn btn-sm btn-warning">
            <i class="bi bi-clipboard-check"></i> 见证工作间
            {{ if gt $.PendingOrderCount 0 }}
            <span class="badge">{{ $.PendingOrderCount }}</span>
            {{ end }}
          </a>
          {{ else }}
          <a href="/v1/office-desk?team_id={{ $.TeamBean.Team.Uuid }}&member_id={{ .Member.Id }}"
            class="btn btn-sm btn-primary">
            <i class="bi bi-pc-display-horizontal"></i> 办公桌
          </a>
          {{ end }}
        </div>
        {{ end }}

      </div>
    </div>

    <hr />
    {{ end }}

  </div>
</div>

{{ end }}